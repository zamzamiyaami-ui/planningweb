<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Sistem Planning Otomatis</title>
  <style>
    body{font-family:Arial;background:#f4f6f8;padding:20px}
    .box{max-width:600px;margin:auto;background:#fff;padding:20px;border-radius:8px}
    label{display:block;margin-top:10px;font-weight:bold}
    input,select,button{width:100%;padding:8px;margin-top:5px}
    button{margin-top:15px;background:#007bff;color:#fff;border:none;cursor:pointer;border-radius:4px}
    .output{margin-top:30px}
    .day{background:#eef2f5;padding:15px;margin-bottom:15px;border-radius:8px}
    .completed{text-decoration:line-through;color:#888} /* Styling untuk kegiatan yang selesai */
    ul{list-style:none;padding:0} /* Hapus bullet default */
    li{display:flex;align-items:center;margin-bottom:5px} /* Flexbox untuk checkbox dan teks */
    input[type="checkbox"]{margin-right:10px} /* Spasi checkbox */
  </style>
</head>
<body>
  <div class="box">
    <h2>Input Planning</h2>

    <label>Hari</label>
    <select id="hari">
      <option>Senin</option><option>Selasa</option><option>Rabu</option>
      <option>Kamis</option><option>Jumat</option><option>Sabtu</option><option>Minggu</option>
    </select>

    <label>Waktu</label>
    <select id="waktu">
      <option>Pagi</option><option>Siang</option><option>Sore</option><option>Malam</option>
    </select>

    <label>Kegiatan</label>
    <input type="text" id="kegiatan" placeholder="Masukkan kegiatan">

    <button onclick="simpan()">Simpan</button>
    <button onclick="reset()" style="background:#dc3545">Reset</button>

    <div class="output" id="areaCetak">
      <h2>Output Planning</h2>
      <div id="output"></div>
    </div>

    <button onclick="cetakJPG()" style="background:#28a745">Cetak JPG</button>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script>
    const urutanHari=['Senin','Selasa','Rabu','Kamis','Jumat','Sabtu','Minggu'];
    const urutanWaktu=['Pagi','Siang','Sore','Malam'];
    const data = JSON.parse(localStorage.getItem('planning')) || {};

    // Tambahkan event listener untuk Enter pada input kegiatan
    document.getElementById('kegiatan').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        simpan();
      }
    });

    function simpan(){
      const h=hari.value;
      const w=waktu.value;
      const k=kegiatan.value.trim();
      if(!k) return alert('Kegiatan tidak boleh kosong');

      if(!data[h]) data[h]={};
      if(!data[h][w]) data[h][w]=[];

      // Ubah struktur data: dari string ke objek {text, completed}
      data[h][w].push({text: k, completed: false});
      localStorage.setItem('planning', JSON.stringify(data));
      kegiatan.value='';
      tampilkan();
    }

    function tampilkan(){
      output.innerHTML='';
      urutanHari.forEach(h=>{
        if(data[h]){
          const div=document.createElement('div');
          div.className='day';
          div.innerHTML=`<h3>${h}</h3>`;
          urutanWaktu.forEach(w=>{
            if(data[h][w]){
              div.innerHTML+=`<strong>${w}</strong><ul>`;
              data[h][w].forEach((item, index) => {
                const checked = item.completed ? 'checked' : '';
                const classCompleted = item.completed ? 'completed' : '';
                div.innerHTML += `<li>
                  <input type="checkbox" ${checked} onchange="toggleCompleted('${h}', '${w}', ${index})">
                  <span class="${classCompleted}">${item.text}</span>
                </li>`;
              });
              div.innerHTML+='</ul>';
            }
          });
          output.appendChild(div);
        }
      });
    }

    // Fungsi untuk toggle status completed
    function toggleCompleted(h, w, index) {
      data[h][w][index].completed = !data[h][w][index].completed;
      localStorage.setItem('planning', JSON.stringify(data));
      tampilkan(); // Update tampilan setelah toggle
    }

    function reset(){
      if(confirm('Reset semua planning?')){
        localStorage.removeItem('planning');
        location.reload();
      }
    }

    function cetakJPG(){
      html2canvas(document.getElementById('areaCetak')).then(canvas=>{
        const a=document.createElement('a');
        a.href=canvas.toDataURL('image/jpeg');
        a.download='jadwal-mingguan.jpg';
        a.click();
      });
    }

    tampilkan();
  </script>
</body>
</html>

